' Gambas class file

Public Sub Button1_Click()
  Dim ColorValue As String = Str(ColorChooser1.Value)
  Dim HexColor As String = Hex(ColorValue)
  Dim strHexColor As String
  Dim Button1Text As String = "Copy color HEX to clipboard:"
  
  If Len(HexColor) = 1 Then
    strHexColor = "00000" & Str(HexColor)
    Button1.Text = Button1Text & " #" & strHexColor
    Panel1.Background = ColorValue
    Clipboard.Copy("#" & strHexColor)
  Else If Len(HexColor) = 2 Then
    strHexColor = "0000" & Str(HexColor)
    Button1.Text = Button1Text & " #" & strHexColor
    Panel1.Background = ColorValue
    Clipboard.Copy("#" & strHexColor)
  Else If Len(HexColor) = 3 Then
    strHexColor = "000" & Str(HexColor)
    Button1.Text = Button1Text & " #" & strHexColor
    Panel1.Background = ColorValue
    Clipboard.Copy("#" & strHexColor)
  Else If Len(HexColor) = 4 Then
    strHexColor = "00" & Str(HexColor)
    Button1.Text = Button1Text & " #" & strHexColor
    Panel1.Background = ColorValue
    Clipboard.Copy("#" & strHexColor)
  Else If Len(HexColor) = 5 Then
    strHexColor = "0" & Str(HexColor)
    Button1.Text = Button1Text & " #" & strHexColor
    Panel1.Background = ColorValue
    Clipboard.Copy("#" & strHexColor)
  Else
    Button1.Text = Button1Text & " #" & HexColor
    Panel1.Background = ColorValue
    Clipboard.Copy("#" & HexColor)
  Endif

End
